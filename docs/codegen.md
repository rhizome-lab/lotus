# Type Generation

ViwoScript uses a custom type generation system to provide TypeScript definitions for all available opcodes. This ensures that developers (and AI agents) have full type safety when writing scripts.

## Overview

The type definitions are generated by scanning the codebase for exported functions created with `defineOpcode`.

- **Source Script**: `packages/core/scripts/generate-types.ts`
- **Generator Logic**: `packages/scripting/src/type_generator.ts`
- **Output File**: `packages/core/src/types.ts`

## How to Update Types

If you add a new opcode or modify an existing one, you must regenerate the type definitions.

### 1. Define Opcode

Use the `defineOpcode` helper to create your opcode and provide metadata.

```typescript
import { defineOpcode } from "../def";

export const myOpcode = defineOpcode<[number], void>("my_opcode", {
  metadata: {
    label: "My Opcode",
    category: "misc",
    description: "Does something cool",
    slots: [],
    parameters: [{ name: "arg", type: "number" }],
    returnType: "void",
  },
  handler: ([arg], ctx) => {
    // Implementation
  },
});
```

### 2. Run Generator

You can run the generator directly or use the commit script which handles it automatically.

```bash
# Generate types only
bun generate:types

# Commit changes (automatically generates types and formats)
bun commit
# OR
bun commit -am 'viwo: update types'
# OR
bun commit --amend
```

### 3. Verify

Check `packages/core/src/types.ts` and/or `packages/scripting/src/types.ts` to ensure your new opcode is present and correctly typed.
